(self.webpackChunkng_alain=self.webpackChunkng_alain||[]).push([[307],{4307:(t,n,e)=>{"use strict";e.r(n),e.d(n,{PassportModule:()=>ot});var r=e(1547),i=e(6406),o=e(7716),s=e(922),a=e(3423);let l=(()=>{class t{constructor(t,n,e){this.socialService=t,this.settingsSrv=n,this.route=e,this.type=""}ngOnInit(){this.type=this.route.snapshot.params.type,this.mockModel()}mockModel(){const t={token:"123456789",name:"cipchk",email:`${this.type}@${this.type}.com`,id:1e4,time:+new Date};this.settingsSrv.setUser(Object.assign(Object.assign({},this.settingsSrv.user),t)),this.socialService.callback(t)}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(i.VK),o.Y36(s.gb),o.Y36(a.gz))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-callback"]],features:[o._Bn([i.VK])],decls:0,vars:0,template:function(t,n){},encapsulation:2}),t})();var c=e(665),p=e(5329),u=e(5887),g=e(6704),d=e(4514),m=e(7674),h=e(4453),f=e(9374);let z=(()=>{class t{constructor(t,n,e,r){this.tokenService=n,this.settings=e,this.router=r,this.f=t.group({password:[null,c.kI.required]})}get user(){return this.settings.user}submit(){for(const t in this.f.controls)this.f.controls[t].markAsDirty(),this.f.controls[t].updateValueAndValidity();this.f.valid&&(console.log("Valid!"),console.log(this.f.value),this.tokenService.set({token:"123"}),this.router.navigate(["dashboard"]))}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(c.qu),o.Y36(i.T),o.Y36(s.gb),o.Y36(a.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["passport-lock"]],decls:15,vars:11,consts:[[1,"ant-card","width-lg",2,"margin","0 auto"],[1,"ant-card-body"],[1,"avatar"],["nzIcon","user","nzSize","large",3,"nzSrc"],["nz-form","","role","form",1,"mt-md",3,"formGroup","ngSubmit"],[3,"nzErrorTip"],["nzSuffixIcon","lock"],["type","password","nz-input","","formControlName","password"],["nzType","flex","nzAlign","middle"],[2,"text-align","right",3,"nzOffset","nzSpan"],["nz-button","","nzType","primary",3,"disabled"]],template:function(t,n){1&t&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"div",2),o._UZ(3,"nz-avatar",3),o.qZA(),o.TgZ(4,"form",4),o.NdJ("ngSubmit",function(){return n.submit()}),o.TgZ(5,"nz-form-item"),o.TgZ(6,"nz-form-control",5),o.ALo(7,"i18n"),o.TgZ(8,"nz-input-group",6),o._UZ(9,"input",7),o.qZA(),o.qZA(),o.qZA(),o.TgZ(10,"nz-row",8),o.TgZ(11,"nz-col",9),o.TgZ(12,"button",10),o._uU(13),o.ALo(14,"i18n"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t&&(o.xp6(3),o.Q6J("nzSrc",n.user.avatar),o.xp6(1),o.Q6J("formGroup",n.f),o.xp6(2),o.Q6J("nzErrorTip",o.lcZ(7,7,"validation.password.required")),o.xp6(5),o.Q6J("nzOffset",12)("nzSpan",12),o.xp6(1),o.Q6J("disabled",!n.f.valid),o.xp6(1),o.Oqu(o.lcZ(14,9,"app.lock")))},directives:[p.Dz,c._Y,c.JL,u.Lr,c.sg,g.SK,u.Nx,g.t3,u.Fd,d.w,m.gB,m.Zp,c.Fj,c.JJ,c.u,h.ix,f.dQ],pipes:[s.w5],styles:["[_nghost-%COMP%]     .ant-card-body{position:relative;margin-top:80px}[_nghost-%COMP%]     .avatar{position:absolute;top:-20px;left:50%;margin-left:-20px}"]}),t})();var Z=e(7048),b=e(7499),A=e(8939),v=e(3805),x=e(4828),w=e(8583),q=e(2079),T=e(7420),k=e(464),y=e(480);function S(t,n){if(1&t&&o._UZ(0,"nz-alert",27),2&t){const t=o.oxw();o.Q6J("nzType","error")("nzMessage",t.error)("nzShowIcon",!0)}}function _(t,n){1&t&&(o.ynx(0),o._uU(1),o.ALo(2,"i18n"),o.BQk()),2&t&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"validation.phone-number.required")," "))}function J(t,n){1&t&&(o.ynx(0),o._uU(1),o.ALo(2,"i18n"),o.BQk()),2&t&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"validation.phone-number.wrong-format")," "))}function I(t,n){if(1&t&&(o.YNc(0,_,3,3,"ng-container",28),o.YNc(1,J,3,3,"ng-container",28)),2&t){const t=n.$implicit;o.Q6J("ngIf",t.errors.required),o.xp6(1),o.Q6J("ngIf",t.errors.pattern)}}let Q=(()=>{class t{constructor(t,n,e,r,i,o,s,a,l){this.router=n,this.settingsService=e,this.socialService=r,this.reuseTabService=i,this.tokenService=o,this.startupSrv=s,this.http=a,this.cdr=l,this.error="",this.type=0,this.loading=!1,this.count=0,this.form=t.group({userName:[null,[c.kI.required,c.kI.pattern(/^(admin|user)$/)]],password:[null,[c.kI.required,c.kI.pattern(/^(ng\-alain\.com)$/)]],mobile:[null,[c.kI.required,c.kI.pattern(/^1\d{10}$/)]],captcha:[null,[c.kI.required]],remember:[!0]})}get userName(){return this.form.controls.userName}get password(){return this.form.controls.password}get mobile(){return this.form.controls.mobile}get captcha(){return this.form.controls.captcha}switch({index:t}){this.type=t}getCaptcha(){if(this.mobile.invalid)return this.mobile.markAsDirty({onlySelf:!0}),void this.mobile.updateValueAndValidity({onlySelf:!0});this.count=59,this.interval$=setInterval(()=>{this.count-=1,this.count<=0&&clearInterval(this.interval$)},1e3)}submit(){if(this.error="",0===this.type){if(this.userName.markAsDirty(),this.userName.updateValueAndValidity(),this.password.markAsDirty(),this.password.updateValueAndValidity(),this.userName.invalid||this.password.invalid)return}else if(this.mobile.markAsDirty(),this.mobile.updateValueAndValidity(),this.captcha.markAsDirty(),this.captcha.updateValueAndValidity(),this.mobile.invalid||this.captcha.invalid)return;this.loading=!0,this.cdr.detectChanges(),this.http.post("/login/account?_allow_anonymous=true",{type:this.type,userName:this.userName.value,password:this.password.value}).pipe((0,A.x)(()=>{this.loading=!0,this.cdr.detectChanges()})).subscribe(t=>{if("ok"!==t.msg)return this.error=t.msg,void this.cdr.detectChanges();this.reuseTabService.clear(),t.user.expired=+new Date+3e5,this.tokenService.set(t.user),this.startupSrv.load().subscribe(()=>{let t=this.tokenService.referrer.url||"/";t.includes("/passport")&&(t="/"),this.router.navigateByUrl(t)})})}open(t,n="href"){let e="",r="";switch(r=b.N.production?`https://ng-alain.github.io/ng-alain/#/passport/callback/${t}`:`http://localhost:4200/#/passport/callback/${t}`,t){case"auth0":e=`//cipchk.auth0.com/login?client=8gcNydIDzGBYxzqV0Vm1CX_RXH-wsWo5&redirect_uri=${decodeURIComponent(r)}`;break;case"github":e=`//github.com/login/oauth/authorize?client_id=9d6baae4b04a23fcafa2&response_type=code&redirect_uri=${decodeURIComponent(r)}`;break;case"weibo":e=`https://api.weibo.com/oauth2/authorize?client_id=1239507802&response_type=code&redirect_uri=${decodeURIComponent(r)}`}"window"===n?this.socialService.login(e,"/",{type:"window"}).subscribe(t=>{t&&(this.settingsService.setUser(t),this.router.navigateByUrl("/"))}):this.socialService.login(e,"/",{type:"href"})}ngOnDestroy(){this.interval$&&clearInterval(this.interval$)}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(c.qu),o.Y36(a.F0),o.Y36(s.gb),o.Y36(i.VK),o.Y36(Z.Wu,8),o.Y36(i.T),o.Y36(v.HS),o.Y36(s.lP),o.Y36(o.sBO))},t.\u0275cmp=o.Xpm({type:t,selectors:[["passport-login"]],features:[o._Bn([i.VK])],decls:54,vars:39,consts:[["nz-form","","role","form",3,"formGroup","ngSubmit"],[1,"tabs",3,"nzAnimated","nzSelectChange"],[3,"nzTitle"],["class","mb-lg",3,"nzType","nzMessage","nzShowIcon",4,"ngIf"],["nzErrorTip","Please enter mobile number, muse be: admin or user"],["nzSize","large","nzPrefixIcon","user"],["nz-input","","formControlName","userName","placeholder","username: admin or user"],["nzErrorTip","Please enter password, muse be: ng-alain.com"],["nzSize","large","nzPrefixIcon","lock"],["nz-input","","type","password","formControlName","password","placeholder","password: ng-alain.com"],[3,"nzErrorTip"],["nz-input","","formControlName","mobile","placeholder","mobile number"],["mobileErrorTip",""],[3,"nzGutter"],[3,"nzSpan"],["nzSize","large","nzPrefixIcon","mail"],["nz-input","","formControlName","captcha","placeholder","captcha"],["type","button","nz-button","","nzSize","large","nzBlock","",3,"disabled","nzLoading","click"],["nz-checkbox","","formControlName","remember"],[1,"text-right",3,"nzSpan"],["routerLink","/passport/register",1,"forgot"],["nz-button","","type","submit","nzType","primary","nzSize","large","nzBlock","",3,"nzLoading"],[1,"other"],["nz-tooltip","","nzTooltipTitle","in fact Auth0 via window","nz-icon","","nzType","alipay-circle",1,"icon",3,"click"],["nz-tooltip","","nzTooltipTitle","in fact Github via redirect","nz-icon","","nzType","taobao-circle",1,"icon",3,"click"],["nz-icon","","nzType","weibo-circle",1,"icon",3,"click"],["routerLink","/passport/register",1,"register"],[1,"mb-lg",3,"nzType","nzMessage","nzShowIcon"],[4,"ngIf"]],template:function(t,n){if(1&t&&(o.TgZ(0,"form",0),o.NdJ("ngSubmit",function(){return n.submit()}),o.TgZ(1,"nz-tabset",1),o.NdJ("nzSelectChange",function(t){return n.switch(t)}),o.TgZ(2,"nz-tab",2),o.ALo(3,"i18n"),o.YNc(4,S,1,3,"nz-alert",3),o.TgZ(5,"nz-form-item"),o.TgZ(6,"nz-form-control",4),o.TgZ(7,"nz-input-group",5),o._UZ(8,"input",6),o.qZA(),o.qZA(),o.qZA(),o.TgZ(9,"nz-form-item"),o.TgZ(10,"nz-form-control",7),o.TgZ(11,"nz-input-group",8),o._UZ(12,"input",9),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(13,"nz-tab",2),o.ALo(14,"i18n"),o.TgZ(15,"nz-form-item"),o.TgZ(16,"nz-form-control",10),o.TgZ(17,"nz-input-group",5),o._UZ(18,"input",11),o.qZA(),o.YNc(19,I,2,2,"ng-template",null,12,o.W1O),o.qZA(),o.qZA(),o.TgZ(21,"nz-form-item"),o.TgZ(22,"nz-form-control",10),o.ALo(23,"i18n"),o.TgZ(24,"nz-row",13),o.TgZ(25,"nz-col",14),o.TgZ(26,"nz-input-group",15),o._UZ(27,"input",16),o.qZA(),o.qZA(),o.TgZ(28,"nz-col",14),o.TgZ(29,"button",17),o.NdJ("click",function(){return n.getCaptcha()}),o._uU(30),o.ALo(31,"i18n"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(32,"nz-form-item"),o.TgZ(33,"nz-col",14),o.TgZ(34,"label",18),o._uU(35),o.ALo(36,"i18n"),o.qZA(),o.qZA(),o.TgZ(37,"nz-col",19),o.TgZ(38,"a",20),o._uU(39),o.ALo(40,"i18n"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(41,"nz-form-item"),o.TgZ(42,"button",21),o._uU(43),o.ALo(44,"i18n"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(45,"div",22),o._uU(46),o.ALo(47,"i18n"),o.TgZ(48,"i",23),o.NdJ("click",function(){return n.open("auth0","window")}),o.qZA(),o.TgZ(49,"i",24),o.NdJ("click",function(){return n.open("github")}),o.qZA(),o.TgZ(50,"i",25),o.NdJ("click",function(){return n.open("weibo","window")}),o.qZA(),o.TgZ(51,"a",26),o._uU(52),o.ALo(53,"i18n"),o.qZA(),o.qZA()),2&t){const t=o.MAs(20);o.Q6J("formGroup",n.form),o.xp6(1),o.Q6J("nzAnimated",!1),o.xp6(1),o.Q6J("nzTitle",o.lcZ(3,21,"app.login.tab-login-credentials")),o.xp6(2),o.Q6J("ngIf",n.error),o.xp6(9),o.Q6J("nzTitle",o.lcZ(14,23,"app.login.tab-login-mobile")),o.xp6(3),o.Q6J("nzErrorTip",t),o.xp6(6),o.Q6J("nzErrorTip",o.lcZ(23,25,"validation.verification-code.required")),o.xp6(2),o.Q6J("nzGutter",8),o.xp6(1),o.Q6J("nzSpan",16),o.xp6(3),o.Q6J("nzSpan",8),o.xp6(1),o.Q6J("disabled",n.count>=0)("nzLoading",n.loading),o.xp6(1),o.hij(" ",n.count?n.count+"s":o.lcZ(31,27,"app.register.get-verification-code")," "),o.xp6(3),o.Q6J("nzSpan",12),o.xp6(2),o.Oqu(o.lcZ(36,29,"app.login.remember-me")),o.xp6(2),o.Q6J("nzSpan",12),o.xp6(2),o.Oqu(o.lcZ(40,31,"app.login.forgot-password")),o.xp6(3),o.Q6J("nzLoading",n.loading),o.xp6(1),o.hij(" ",o.lcZ(44,33,"app.login.login")," "),o.xp6(3),o.hij(" ",o.lcZ(47,35,"app.login.sign-in-with")," "),o.xp6(6),o.Oqu(o.lcZ(53,37,"app.login.signup"))}},directives:[c._Y,c.JL,u.Lr,c.sg,x.xH,x.xw,w.O5,g.SK,u.Nx,g.t3,u.Fd,d.w,m.gB,m.Zp,c.Fj,c.JJ,c.u,h.ix,f.dQ,q.Ie,a.yS,T.SY,k.Ls,y.r],pipes:[s.w5],styles:["[_nghost-%COMP%]{display:block;width:368px;margin:0 auto}[_nghost-%COMP%]     .ant-tabs .ant-tabs-bar{margin-bottom:24px;text-align:center;border-bottom:0}[_nghost-%COMP%]     .ant-tabs-tab{font-size:16px;line-height:24px}[_nghost-%COMP%]     .ant-input-affix-wrapper .ant-input:not(:first-child){padding-left:4px}[_nghost-%COMP%]     .icon{margin-left:16px;color:#0003;font-size:24px;vertical-align:middle;cursor:pointer;transition:color .3s}[_nghost-%COMP%]     .icon:hover{color:#1890ff}[_nghost-%COMP%]     .other{margin-top:24px;line-height:22px;text-align:left}[_nghost-%COMP%]     .other nz-tooltip{vertical-align:middle}[_nghost-%COMP%]     .other .register{float:right}[data-theme=dark]   [_nghost-%COMP%]     .icon{color:#fff3}[data-theme=dark]   [_nghost-%COMP%]     .icon:hover{color:#fff}"],changeDetection:0}),t})();var C=e(6260),N=e(8058),O=e(3797);function L(t,n){if(1&t&&(o.TgZ(0,"div",4),o._uU(1),o.ALo(2,"i18n"),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.hij(" ",o.xi3(2,1,"app.register-result.msg",t.params)," ")}}let P=(()=>{class t{constructor(t,n){this.msg=n,this.params={email:""},this.email="",this.params.email=this.email=t.snapshot.queryParams.email||"ng-alain@example.com"}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(a.gz),o.Y36(N.dD))},t.\u0275cmp=o.Xpm({type:t,selectors:[["passport-register-result"]],decls:10,vars:11,consts:[["type","success",3,"title","description"],["title",""],["nz-button","","nzSize","large",3,"nzType","click"],["routerLink","/","nz-button","","nzSize","large"],[1,"title",2,"font-size","20px"]],template:function(t,n){if(1&t&&(o.TgZ(0,"result",0),o.ALo(1,"i18n"),o.YNc(2,L,3,4,"ng-template",null,1,o.W1O),o.TgZ(4,"button",2),o.NdJ("click",function(){return n.msg.success("email")}),o._uU(5),o.ALo(6,"i18n"),o.qZA(),o.TgZ(7,"button",3),o._uU(8),o.ALo(9,"i18n"),o.qZA(),o.qZA()),2&t){const t=o.MAs(3);o.s9C("description",o.lcZ(1,5,"app.register-result.activation-email")),o.Q6J("title",t),o.xp6(4),o.Q6J("nzType","primary"),o.xp6(1),o.hij(" ",o.lcZ(6,7,"app.register-result.view-mailbox")," "),o.xp6(3),o.hij(" ",o.lcZ(9,9,"app.register-result.back-home")," ")}},directives:[O.N,h.ix,f.dQ,d.w,a.rH],pipes:[s.w5],encapsulation:2}),t})();var U=e(8381),Y=e(2281),M=e(269);function B(t,n){if(1&t&&o._UZ(0,"nz-alert",23),2&t){const t=o.oxw();o.Q6J("nzType","error")("nzMessage",t.error)("nzShowIcon",!0)}}function V(t,n){1&t&&(o.ynx(0),o._uU(1),o.ALo(2,"i18n"),o.BQk()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"validation.email.required")))}function $(t,n){1&t&&(o.ynx(0),o._uU(1),o.ALo(2,"i18n"),o.BQk()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"validation.email.wrong-format")))}function E(t,n){if(1&t&&(o.YNc(0,V,3,3,"ng-container",24),o.YNc(1,$,3,3,"ng-container",24)),2&t){const t=n.$implicit;o.Q6J("ngIf",null==t.errors?null:t.errors.required),o.xp6(1),o.Q6J("ngIf",null==t.errors?null:t.errors.email)}}function D(t,n){1&t&&(o.TgZ(0,"div",32),o._uU(1),o.ALo(2,"i18n"),o.qZA()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"validation.password.strength.strong")))}function j(t,n){1&t&&(o.TgZ(0,"div",33),o._uU(1),o.ALo(2,"i18n"),o.qZA()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"validation.password.strength.medium")))}function G(t,n){1&t&&(o.TgZ(0,"div",34),o._uU(1),o.ALo(2,"i18n"),o.qZA()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"validation.password.strength.short")))}function W(t,n){if(1&t&&(o.TgZ(0,"div",25),o.ynx(1,26),o.YNc(2,D,3,3,"div",27),o.YNc(3,j,3,3,"div",28),o.YNc(4,G,3,3,"div",29),o.BQk(),o.TgZ(5,"div"),o._UZ(6,"nz-progress",30),o.qZA(),o.TgZ(7,"p",31),o._uU(8),o.ALo(9,"i18n"),o.qZA(),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Q6J("ngSwitch",t.status),o.xp6(1),o.Q6J("ngSwitchCase","ok"),o.xp6(1),o.Q6J("ngSwitchCase","pass"),o.xp6(2),o.Gre("progress-",t.status,""),o.xp6(1),o.Q6J("nzPercent",t.progress)("nzStatus",t.passwordProgressMap[t.status])("nzStrokeWidth",6)("nzShowInfo",!1),o.xp6(2),o.Oqu(o.lcZ(9,11,"validation.password.strength.msg"))}}function F(t,n){1&t&&(o.ynx(0),o._uU(1),o.ALo(2,"i18n"),o.BQk()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"validation.confirm-password.required")))}function K(t,n){1&t&&(o.ynx(0),o._uU(1),o.ALo(2,"i18n"),o.BQk()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"validation.password.twice")))}function X(t,n){if(1&t&&(o.YNc(0,F,3,3,"ng-container",24),o.YNc(1,K,3,3,"ng-container",24)),2&t){const t=n.$implicit;o.Q6J("ngIf",null==t.errors?null:t.errors.required),o.xp6(1),o.Q6J("ngIf",null==t.errors?null:t.errors.equar)}}function R(t,n){1&t&&(o.TgZ(0,"nz-select",35),o._UZ(1,"nz-option",36),o._UZ(2,"nz-option",36),o.qZA()),2&t&&(o.xp6(1),o.Q6J("nzLabel","+86")("nzValue","+86"),o.xp6(1),o.Q6J("nzLabel","+87")("nzValue","+87"))}function H(t,n){1&t&&(o.ynx(0),o._uU(1),o.ALo(2,"i18n"),o.BQk()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"validation.phone-number.required")))}function tt(t,n){1&t&&(o.ynx(0),o._uU(1),o.ALo(2,"i18n"),o.BQk()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"validation.phone-number.wrong-format")))}function nt(t,n){if(1&t&&(o.YNc(0,H,3,3,"ng-container",24),o.YNc(1,tt,3,3,"ng-container",24)),2&t){const t=n.$implicit;o.Q6J("ngIf",null==t.errors?null:t.errors.required),o.xp6(1),o.Q6J("ngIf",null==t.errors?null:t.errors.pattern)}}const et=function(){return{"width.px":240}},rt=[{path:"passport",component:C.W,children:[{path:"login",component:Q,data:{title:"\u767b\u5f55",titleI18n:"app.login.login"}},{path:"register",component:(()=>{class t{constructor(n,e,r,i){this.router=e,this.http=r,this.cdr=i,this.error="",this.type=0,this.loading=!1,this.visible=!1,this.status="pool",this.progress=0,this.passwordProgressMap={ok:"success",pass:"normal",pool:"exception"},this.count=0,this.form=n.group({mail:[null,[c.kI.required,c.kI.email]],password:[null,[c.kI.required,c.kI.minLength(6),t.checkPassword.bind(this)]],confirm:[null,[c.kI.required,c.kI.minLength(6),t.passwordEquar]],mobilePrefix:["+86"],mobile:[null,[c.kI.required,c.kI.pattern(/^1\d{10}$/)]],captcha:[null,[c.kI.required]]})}get mail(){return this.form.controls.mail}get password(){return this.form.controls.password}get confirm(){return this.form.controls.confirm}get mobile(){return this.form.controls.mobile}get captcha(){return this.form.controls.captcha}static checkPassword(t){if(!t)return null;const n=this;n.visible=!!t.value,n.status=t.value&&t.value.length>9?"ok":t.value&&t.value.length>5?"pass":"pool",n.visible&&(n.progress=10*t.value.length>100?100:10*t.value.length)}static passwordEquar(t){return t&&t.parent&&t.value!==t.parent.get("password").value?{equar:!0}:null}getCaptcha(){if(this.mobile.invalid)return this.mobile.markAsDirty({onlySelf:!0}),void this.mobile.updateValueAndValidity({onlySelf:!0});this.count=59,this.cdr.detectChanges(),this.interval$=setInterval(()=>{this.count-=1,this.cdr.detectChanges(),this.count<=0&&clearInterval(this.interval$)},1e3)}submit(){if(this.error="",Object.keys(this.form.controls).forEach(t=>{this.form.controls[t].markAsDirty(),this.form.controls[t].updateValueAndValidity()}),this.form.invalid)return;const t=this.form.value;this.loading=!0,this.cdr.detectChanges(),this.http.post("/register?_allow_anonymous=true",t).pipe((0,A.x)(()=>{this.loading=!1,this.cdr.detectChanges()})).subscribe(()=>{this.router.navigate(["passport","register-result"],{queryParams:{email:t.mail}})})}ngOnDestroy(){this.interval$&&clearInterval(this.interval$)}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(c.qu),o.Y36(a.F0),o.Y36(s.lP),o.Y36(o.sBO))},t.\u0275cmp=o.Xpm({type:t,selectors:[["passport-register"]],decls:50,vars:34,consts:[["nz-form","","role","form",3,"formGroup","ngSubmit"],["class","mb-lg",3,"nzType","nzMessage","nzShowIcon",4,"ngIf"],[3,"nzErrorTip"],["nzSize","large","nzAddonBeforeIcon","user"],["nz-input","","formControlName","mail","placeholder","Email"],["mailErrorTip",""],["nzSize","large","nzAddonBeforeIcon","lock","nz-popover","","nzPopoverPlacement","right","nzPopoverTrigger","focus","nzPopoverOverlayClassName","register-password-cdk",3,"nzPopoverVisible","nzPopoverOverlayStyle","nzPopoverContent","nzPopoverVisibleChange"],["nz-input","","type","password","formControlName","password","placeholder","Password"],["pwdCdkTpl",""],["nzSize","large","nzAddonBeforeIcon","lock"],["nz-input","","type","password","formControlName","confirm","placeholder","Confirm Password"],["confirmErrorTip",""],["nzSize","large",3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","mobile","nz-input","","placeholder","Phone number"],["mobileErrorTip",""],[3,"nzGutter"],[3,"nzSpan"],["nzSize","large","nzAddonBeforeIcon","mail"],["nz-input","","formControlName","captcha","placeholder","Captcha"],["type","button","nz-button","","nzSize","large","nzBlock","",3,"disabled","nzLoading","click"],["nz-button","","nzType","primary","nzSize","large","type","submit",1,"submit",3,"nzLoading"],["routerLink","/passport/login",1,"login"],[1,"mb-lg",3,"nzType","nzMessage","nzShowIcon"],[4,"ngIf"],[2,"padding","4px 0"],[3,"ngSwitch"],["class","success",4,"ngSwitchCase"],["class","warning",4,"ngSwitchCase"],["class","error",4,"ngSwitchDefault"],[3,"nzPercent","nzStatus","nzStrokeWidth","nzShowInfo"],[1,"mt-sm"],[1,"success"],[1,"warning"],[1,"error"],["formControlName","mobilePrefix",2,"width","100px"],[3,"nzLabel","nzValue"]],template:function(t,n){if(1&t&&(o.TgZ(0,"h3"),o._uU(1),o.ALo(2,"i18n"),o.qZA(),o.TgZ(3,"form",0),o.NdJ("ngSubmit",function(){return n.submit()}),o.YNc(4,B,1,3,"nz-alert",1),o.TgZ(5,"nz-form-item"),o.TgZ(6,"nz-form-control",2),o.TgZ(7,"nz-input-group",3),o._UZ(8,"input",4),o.qZA(),o.YNc(9,E,2,2,"ng-template",null,5,o.W1O),o.qZA(),o.qZA(),o.TgZ(11,"nz-form-item"),o.TgZ(12,"nz-form-control",2),o.ALo(13,"i18n"),o.TgZ(14,"nz-input-group",6),o.NdJ("nzPopoverVisibleChange",function(t){return n.visible=t}),o._UZ(15,"input",7),o.qZA(),o.YNc(16,W,10,13,"ng-template",null,8,o.W1O),o.qZA(),o.qZA(),o.TgZ(18,"nz-form-item"),o.TgZ(19,"nz-form-control",2),o.TgZ(20,"nz-input-group",9),o._UZ(21,"input",10),o.qZA(),o.YNc(22,X,2,2,"ng-template",null,11,o.W1O),o.qZA(),o.qZA(),o.TgZ(24,"nz-form-item"),o.TgZ(25,"nz-form-control",2),o.TgZ(26,"nz-input-group",12),o.YNc(27,R,3,4,"ng-template",null,13,o.W1O),o._UZ(29,"input",14),o.qZA(),o.YNc(30,nt,2,2,"ng-template",null,15,o.W1O),o.qZA(),o.qZA(),o.TgZ(32,"nz-form-item"),o.TgZ(33,"nz-form-control",2),o.ALo(34,"i18n"),o.TgZ(35,"nz-row",16),o.TgZ(36,"nz-col",17),o.TgZ(37,"nz-input-group",18),o._UZ(38,"input",19),o.qZA(),o.qZA(),o.TgZ(39,"nz-col",17),o.TgZ(40,"button",20),o.NdJ("click",function(){return n.getCaptcha()}),o._uU(41),o.ALo(42,"i18n"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(43,"nz-form-item"),o.TgZ(44,"button",21),o._uU(45),o.ALo(46,"i18n"),o.qZA(),o.TgZ(47,"a",22),o._uU(48),o.ALo(49,"i18n"),o.qZA(),o.qZA(),o.qZA()),2&t){const t=o.MAs(10),e=o.MAs(17),r=o.MAs(23),i=o.MAs(28),s=o.MAs(31);o.xp6(1),o.Oqu(o.lcZ(2,21,"app.register.register")),o.xp6(2),o.Q6J("formGroup",n.form),o.xp6(1),o.Q6J("ngIf",n.error),o.xp6(2),o.Q6J("nzErrorTip",t),o.xp6(6),o.Q6J("nzErrorTip",o.lcZ(13,23,"validation.password.required")),o.xp6(2),o.Q6J("nzPopoverVisible",n.visible)("nzPopoverOverlayStyle",o.DdM(33,et))("nzPopoverContent",e),o.xp6(5),o.Q6J("nzErrorTip",r),o.xp6(6),o.Q6J("nzErrorTip",s),o.xp6(1),o.Q6J("nzAddOnBefore",i),o.xp6(7),o.Q6J("nzErrorTip",o.lcZ(34,25,"validation.verification-code.required")),o.xp6(2),o.Q6J("nzGutter",8),o.xp6(1),o.Q6J("nzSpan",16),o.xp6(3),o.Q6J("nzSpan",8),o.xp6(1),o.Q6J("disabled",n.count>0)("nzLoading",n.loading),o.xp6(1),o.hij(" ",n.count?n.count+"s":o.lcZ(42,27,"app.register.get-verification-code")," "),o.xp6(3),o.Q6J("nzLoading",n.loading),o.xp6(1),o.hij(" ",o.lcZ(46,29,"app.register.register")," "),o.xp6(3),o.Oqu(o.lcZ(49,31,"app.register.sign-in"))}},directives:[c._Y,c.JL,u.Lr,c.sg,w.O5,g.SK,u.Nx,g.t3,u.Fd,d.w,m.gB,m.Zp,c.Fj,c.JJ,c.u,U.lU,h.ix,f.dQ,a.yS,y.r,w.RF,w.n9,w.ED,Y.M,M.Vq,M.Ip],pipes:[s.w5],styles:["[_nghost-%COMP%]{display:block;width:368px;margin:0 auto}[_nghost-%COMP%]     h3{margin-bottom:20px;font-size:16px}[_nghost-%COMP%]     .submit{width:50%}[_nghost-%COMP%]     .login{float:right;line-height:40px}  .register-password-cdk .error,   .register-password-cdk .success,   .register-password-cdk .warning{transition:color .3s}  .register-password-cdk .success{color:#52c41a}  .register-password-cdk .warning{color:#faad14}  .register-password-cdk .error{color:#ff4d4f}  .register-password-cdk .progress-pass>.progress .ant-progress-bg{background-color:#faad14}"],changeDetection:0}),t})(),data:{title:"\u6ce8\u518c",titleI18n:"app.register.register"}},{path:"register-result",component:P,data:{title:"\u6ce8\u518c\u7ed3\u679c",titleI18n:"app.register.register"}},{path:"lock",component:z,data:{title:"\u9501\u5c4f",titleI18n:"app.lock"}}]},{path:"passport/callback/:type",component:l}];let it=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[a.Bz.forChild(rt)],a.Bz]}),t})(),ot=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.m8,it]]}),t})()}}]);